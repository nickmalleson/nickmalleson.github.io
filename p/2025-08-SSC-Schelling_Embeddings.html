<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="author" content="Nick Malleson">
        <meta name="keywords" content="Large-language model, foundation model, embeddings, ABM">

		<title>
			Towards the use of Foundation Models and Embeddings for Nuanced Perception and Decision-Making in Agents
		</title>

		<link rel="stylesheet" href="reveal/css/reveal.css">
		<link rel="stylesheet" href="reveal/css/theme/white.css">
        
        <!-- Some extra bits added by Nick -->
        <link rel="stylesheet" href="reveal/css/nick.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal/css/print/pdf.css' : 'reveal/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
 
                    
                <section class="title" id="title" 
                         data-background-image="../figures/chatgpt/digital_city_abm.png"
                         >
                    <div class="whitebackground2">
                        <!--
                        <a href="https://europa.eu/european-union/index_en">
                            <img style="float:left;padding:10px 50px 10px 50px;width:70px; height:auto;" 
                                 data-src="../figures/LOGO_EU.jpg"/>
                        </a>
                        

                        <a href="http://www.leeds.ac.uk/">
                            <img style="float:right;padding:10px;width:150px; height:auto;" 
                                 data-src="../figures/uol_logo.gif"/>
                        </a>
                        -->
                        <h5>Social Simulation Conference (SSC) 2025</h5>

                        <hr/>
                        <h2 style="font-size: 150%">
                            Foundation Models and Embeddings for Nuanced Perception and Decision-Making in Agents
						</h2>
                        <hr/>
                        <h3>Nick Malleson, Ed Manley</h3>
                        <h4 style="font-size: 90%">School of Geography, University of Leeds, UK</h4>
                        <hr/>
                        <h4 style="text-align:center">These slides: <a href="https://www.nickmalleson.co.uk/presentations.html">www.nickmalleson.co.uk/presentations.html</a></h4>
                        <!--
                        <p style="font-size: 14pt; text-align: center">
                            This research is supported by UKRI (ESRC) funding ES/Y006259/1 under the 
                            Digital Footprints scheme</p>
                        -->
                    </div>
                    
                    <aside class="notes">
                        Following the emergence of powerful generative large lan-
                        guage models (LLMs), there has been a flurry of interest in the use of
                        LLMs to control agents in agent-based models. Proponents argue that
                        using the information about humans and human behaviour contained
                        within an LLM could lead to the creation of agents who exhibit more
                        complex and nuanced behaviour than those whose actions are driven by
                        traditional behavioural frameworks. This paper begins to explore the use
                        of a specific concept that underpins LLMs; that of embeddings. An em-
                        bedding is a vector-based numerical representation of a piece of text that
                        captures aspects of its meaning and context. We hypothesise that concep-
                        tualising agentsâ€™ characteristics through embeddings, rather than with
                        discrete state variables, may offer a more nuanced and expressive foun-
                        dation for representing agent characteristics and behaviours. We demon-
                        strate the potential of this approach by recreating the Schelling residen-
                        tial segregation model using rich text descriptions of household agents
                        and converting these to embeddings as a means of defining agents. The
                        results show how agents can self-organise into more diverse and emer-
                        gent clusters than is possible when they are defined with a small number
                        of discrete attributes. This offers a path toward mor
                    </aside>
                </section>
                
                                
                <section id="outline">
                    <img data-src="../figures/chatgpt/digital_city_abm.png" 
                         class="right" style="width:35%;"/>
                    <h2>Overview</h2>
                    <p>Aim: Towards a more detailed representation of individuals 
                        using <i>embeddings</i></p>
                    <p class="l2">Background to large language models (LLMs) and embeddings</p>
                    <p class="l2">Embeddings for nuanced household descriptions</p>
                    <p class="l2">Prototype: Schelling with embeddings</p>
                    <h3>Code Availability</h3>
                    <p>GitHub repository: <a href="https://github.com/nickmalleson/playground/blob/main/llm/schelling_embeddings/schelling_embeddings.ipynb">
                    github.com/nickmalleson/playground/tree/main/llm/schelling_embeddings</a></p>
                </section>
                
                <section id="background">
                    <h2>Background: Heterogeneity in ABMs</h2>
                    <p>Some agent characteristics can be accurately represented with numeric or 
                        categorical parameters:</p>
                    <p class="l2">E.g. Age, income, household type, level of education etc.</p>
                    <p>But other aspects are much more nuanced</p>
                    <p class="l2">E.g. "I like the government's economic policies, but I am
                        nervous about their approach to immigration and the quality of our
                        public health system."</p>
                    <p>Maybe these more nuanced characteristics could be better represented
                    by <i>embeddings</i>...</p>
                </section>
                
                <section id="embedings">
                    <h2>What are embeddings?</h2>
                    <p>One of the innovations that underpin large-language models (LLMs)</p>
                    <p>Long vectors of numbers that represent the <i>characteristics</i> of words</p>
                    <img data-src="../figures/paper_figures/2025-SSC-Schelling_Embeddings/embeddings_example.png"
                         style="width:70%;"
                         alt="Hypothetical word embeddings showing how different words could be
                              represented as numeric vectors across abstract dimensions"
                         />
                    <p><i>Transformer</i> architecture uses <i>self attention</i> for dynamic embeddings</p>
                    <p class="l2">I.e. distinguish 'savings bank' from 'river bank' depending on context</p>
                </section>
                
                <section id="schelling_embeddings">
                    <h2>Overview of the Experiments</h2>
                    <p>Adapt Schelling's model of residential segregation, but embeddings
                    replace binary household characteristics.</p>
                    <p>Process:</p>
                    <p class="l2">1. use an LLM to create 300 hypothetical household descriptions 
                    (in future these could come from surveys etc.).</p>
                    <p class="l2">2. calculate an embedding for each household and put them into
                        a regular grid model</p>
                    <p class="l2">3. in the model, agents move if their embedding is sufficiently
                        different to the embeddings of their neighbours (use a threshold to decide)</p>
                    <p class="l2">4. run the model until it reaches equilibrium</p>
                </section>
                
                <section id="household_descriptions">
                    <h2>Household descriptions</h2>
                    <p>Three dimensions for each agent: (i) household structure; 
                        (ii) income; and (iii) political beliefs</p>
                    <p>Descriptions are generated using an open-source LLM:</p>
                    <p class="l2"><a href="https://huggingface.co/meta-llama/Llama-4-Maverick-17B-128E-Instruct-FP8">
                        Llama-4-Maverick-17B-128E-Instruct-FP8</a> (accessed the LLM using the <a href="">Together.AI</a>
                        service -- cheap and makes it easy to access very big models)</p>
                    <p>Prompt:</p>
                    <p class="l2" style="font-family: courier">
                        Produce <i>N</i> one-sentence, anonymous, detailed descriptions of stereotypical
                        UK households, describing their household structure, income and
                        political beliefs. Output in CSV format with one line per household description 
                        and nothing else.</p>
                </section>
                
                
                <section id="household_descriptions-example">
                    <h2>Five household descriptions</h2>
                    <table style="width:100%; border-collapse:collapse;
                                  font-size: 60%;">
                      <thead>
                        <tr>
                          <th style="border:1px solid #000; padding:8px; width:6%">ID</th>
                          <th style="border:1px solid #000; padding:8px; width:94%">Description</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td style="border:1px solid #000; padding:8px;">0</td>
                          <td style="border:1px solid #000; padding:8px;">A retired couple living alone in a semi-detached house in a suburban area, relying on state pensions and modest savings, strongly supporting the Conservative party.</td>
                        </tr>
                        <tr>
                          <td style="border:1px solid #000; padding:8px;">1</td>
                          <td style="border:1px solid #000; padding:8px;">An elderly couple residing in a suburban, semi-detached house, drawing income from their savings and their state pensions, voting for the Conservative party consistently.</td>
                        </tr>
                        <tr>
                          <td style="border:1px solid #000; padding:8px;">2</td>
                          <td style="border:1px solid #000; padding:8px;">A young, single professional renting a studio flat in a city centre, earning a salary around Â£35,000 from a career in marketing, voting for the Liberal Democrats and actively campaigning for environmental causes.</td>
                        </tr>
                        <tr>
                          <td style="border:1px solid #000; padding:8px;">3</td>
                          <td style="border:1px solid #000; padding:8px;">A large, multi-generational family residing in a terraced house, with the patriarch working as a manual labourer on a zero-hours contract, the matriarch a part-time carer, and several children, identifying as Labour supporters and strongly union-backed.</td>
                        </tr>
                        <tr>
                          <td style="border:1px solid #000; padding:8px;">4</td>
                          <td style="border:1px solid #000; padding:8px;">A single parent with three children, living in a council flat, surviving on a tight budget that includes Universal Credit and Child Tax Credits, and staunchly supporting the Labour party, particularly its more left-wing elements.</td>
                        </tr>
                      </tbody>
                    </table>
                </section>
                    
                
                <section id="household_embeddings">
                    <h2>Household Embeddings</h2>
                    <p>Descriptions converted to embeddings using 
                        <a href="https://huggingface.co/nreimers/MiniLM-L6-H384-uncased">
                            MiniLM-L6-H384-uncased</a></p>
                    <p>Process:</p>
                    <p class="l2">Each text description is tokenised into subword units and passed 
                        through the transformer, which uses self-attention to generate 
                        contextualised vector representations for each token</p>
                    <p class="l2">Word embeddings aggregated into a single 382-element vector
                        using mean pooling (common approach for creating 'sentence embeddings')</p>
                    <p>For visualising household types:</p>
                    <p class="l2">Use Principal Component Analysis (PCA) to reduce the 382-element embeddings
                        into 3-element vectors and assign these to R,G,B colour components</p>
                    <p class="l2">(not ideal but OK for demonstrative purposes)</p>
                    
                </section>
                
                <section id="embedding_similarity">
                    <h2>Embedding similarity</h2>
                    <p>Similar household descriptions should have similar embeddings
                        (calculated using <i>cosine similarity</i>)</p>
                    <img src="../figures/paper_figures/2025-SSC-Schelling_Embeddings/similarity_matrix_example%20copy.png"
                         alt="Similarity of the five example embeddings" 
                         style="width:60%;"
                         />
                </section>
                
                <section id="results-test">
                    <h2>Results: 5 households test</h2>
                    <p>Run the model with only the five example household types</p>
                    <figure class="left" style="width: 45%; padding: 0px">
                        <img src="../figures/paper_figures/2025-SSC-Schelling_Embeddings/Initial_Agent_Locations-Example.png"/>
                        <figcaption>Initial agent locations</figcaption>
                    </figure>
                    <figure class="right" style="width: 45%; padding: 0px">
                        <img src="../figures/paper_figures/2025-SSC-Schelling_Embeddings/Final_Agent_Locations-Example.png"/>
                        <figcaption>Final agent locations</figcaption>
                    </figure>
                </section>
                
                <section id="results-full">
                    <h2>Final results (300 distinct agent types)</h2>
                    <img src="../figures/paper_figures/2025-SSC-Schelling_Embeddings/Final_Agent_Locations.png" 
                         style="width: 60%"
                         alt="The final locations of the agents in the full model"/>
                </section>
                
                <section id="conclusions1">
                    <h2>Summary</h2>
                    <p>Demonstrate that <i>embeddings</i> can be used to create
                    rich, heterogeneous agents</p>
                    <p>In a Schelling-like model, agents cluster depending on the
                        similarity of their embeddings</p>
                    <p>Challenges:</p>
                    <p class="l2">Bias in LLMs lead to biased embeddings? (Resolve with fine-tuning?)</p>
                    <p class="l2">Computational: if LLMs become more integral to ABMs
                        then the computational requirements explode</p>
                </section>
                
                <section id="future_work">
                    <h2>Future work</h2>
                    <p>Multi-model agents</p>
                    <p class="l2">Lots of excitement in using LLMs to control agents,
                        but can they also be made <i>multi-modal</i>? (I.e. interpret
                        different types of embeddings, not just text).</p>
                    <p>Dynamic environments</p>
                    <p class="l2">LLM reasoning may be 'unbounded', but agents are limited
                        by the simulation environment.</p>
                    <p class="l2">i.e. what if our Schelling agents decide that they would rather
                        modernise their house than move?</p>
                </section>


				<section>
					<img src="../figures/Flyer_CEUS_SI-DT_AI_Cities.png"
				 />

				</section>
                

                
                
                <section class="title" id="thanks" 
                         data-background-image="../figures/chatgpt/digital_city_abm.png"
                         >
                    <div class="whitebackground2">

                        <h5>Social Simulation Conference (SSC) 2025</h5>

                        <hr/>
                        <h2 style="font-size: 150%">
                            Foundation Models and Embeddings for Nuanced Perception and Decision-Making in Agents
						</h2>
                        <hr/>
                        <h3>Nick Malleson, Ed Manley</h3>
                        <h4 style="font-size: 90%">School of Geography, University of Leeds, UK</h4>
                        <hr/>
                        <h4 style="text-align:center">These slides: <a href="https://www.nickmalleson.co.uk/presentations.html">www.nickmalleson.co.uk/presentations.html</a></h4>
                    </div>
                    
                </section>
                

                
                
			</div>
		</div>

		<script src="reveal/lib/js/head.min.js"></script>
		<script src="reveal/js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'reveal/plugin/markdown/marked.js' },
					{ src: 'reveal/plugin/markdown/markdown.js' },
					{ src: 'reveal/plugin/notes/notes.js', async: true },
					{ src: 'reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
